# Archive（归档变更）

## 使用时机

当所有任务完成，需要归档时使用此 prompt。

## 归档前检查 Prompt

```
## 检查点 1：测试覆盖

请检查本次提案中，是否前后端所有功能均添加了自动化测试。

## 检查点 2：全量测试

请在本仓库执行全量测试，并将所有失败修复到全绿，同时汇总 warnings。

### 目标与原则（必须遵循）

1. 对每个失败先做根因分析，再修复；修复应与本次开发提案/架构方向一致（以提案为规范来源）
2. 允许对提案涉及的模块做结构性修复，对提案无关区域优先最小必要改动：
   - 控制改动面与回归风险
   - 但如果根因需要重构/调整设计，允许做必要重构
   - 必须说明必要性、影响范围与验证方式
3. 禁止取巧：
   - 不得通过 skip/xfail、删除测试、显著弱化断言、全局吞异常、或关闭/全局过滤 warnings 来让测试通过
4. 若测试本身与提案或真实行为不一致，允许修改测试，但必须说明依据（提案条目/接口契约/业务语义）并确保测试更"正确"而非更"宽松"

## 检查点 3：确认与归档

1. 请确认 tasks 全部完成
2. 确认 spec delta 已合并且与实现一致
3. 如有遗留项，必须显式记录为后续 change
4. 执行 openspec archive <change-id> --yes
5. 最后执行 git commit，只提交本次提案相关文件
   - 在 git 备注中简要阐述本提案和执行过程
```

## 归档命令

```bash
# 归档 change
openspec archive <change-id> --yes
```
